<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billing Form (9 Items)</title>
    <style>
        /* Basic styling for a clean, modern look */
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        
        .billing-form-container {
            background-color: #ffffff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 700px;
            overflow-y: auto;
            max-height: 90vh;
        }
        
        h2 {
            text-align: center;
            color: #333;
        }
        
        label {
            font-weight: bold;
            margin-bottom: 5px;
            display: inline-block;
        }
        
        input,
        textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        
        .item-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .item-row textarea {
            flex: 3;
            resize: none;
        }
        
        .item-row input {
            flex: 1;
        }
        
        .item-row button {
            flex: 0.5;
            background-color: #f44336;
            color: white;
            border: none;
            padding: 6px 10px;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .item-row button:hover {
            background-color: #d32f2f;
        }
        
        .total-container {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>

<body>
    <div class="billing-form-container" id="billing-info">
        <h2>Billing Information</h2>
        <form id="billing-form" method="post" onsubmit="submitBillingForm(event)">
            <!-- Invoice Number (Auto-generated) -->
            <label for="invoice-number">Invoice Number:</label>
            <input type="text" name="invoice_number" id="invoice-number" readonly><br>

            <!-- Customer Name -->
            <label for="customer_name">Customer Name:</label>
            <input type="text" name="customer_name" required><br>

            <!-- Customer Email -->
            <label for="customer_email">Customer Email:</label>
            <input type="email" name="customer_email" required><br>

            <!-- Items -->
            <div id="items-container">
                <!-- Pre-filled items -->
                <div class="item-row">
                    <textarea name="items[0][description]" required>1. Earth excavation in hard soil for foundation trenches...</textarea>
                    <input type="number" name="items[0][quantity]" placeholder="Qty" required oninput="updateTotal()">
                    <input type="number" name="items[0][price]" placeholder="Price (₹)" required oninput="updateTotal()">
                    <button type="button" onclick="removeItem(this)">Remove</button>
                </div>
                <div class="item-row">
                    <textarea name="items[1][description]" required>2. PCC (1:4:8) for flooring and foundation...</textarea>
                    <input type="number" name="items[1][quantity]" placeholder="Qty" required oninput="updateTotal()">
                    <input type="number" name="items[1][price]" placeholder="Price (₹)" required oninput="updateTotal()">
                    <button type="button" onclick="removeItem(this)">Remove</button>
                </div>
                <div class="item-row">
                    <textarea name="items[2][description]" required>3. RCC (1:2:4) for flooring, slabs, and walls...</textarea>
                    <input type="number" name="items[2][quantity]" placeholder="Qty" required oninput="updateTotal()">
                    <input type="number" name="items[2][price]" placeholder="Price (₹)" required oninput="updateTotal()">
                    <button type="button" onclick="removeItem(this)">Remove</button>
                </div>
                <div class="item-row">
                    <textarea name="items[3][description]" required>4. Brick masonry work for walls and partitions...</textarea>
                    <input type="number" name="items[3][quantity]" placeholder="Qty" required oninput="updateTotal()">
                    <input type="number" name="items[3][price]" placeholder="Price (₹)" required oninput="updateTotal()">
                    <button type="button" onclick="removeItem(this)">Remove</button>
                </div>
                <div class="item-row">
                    <textarea name="items[4][description]" required>5. Plastering walls and ceilings (inside and outside)...</textarea>
                    <input type="number" name="items[4][quantity]" placeholder="Qty" required oninput="updateTotal()">
                    <input type="number" name="items[4][price]" placeholder="Price (₹)" required oninput="updateTotal()">
                    <button type="button" onclick="removeItem(this)">Remove</button>
                </div>
                <div class="item-row">
                    <textarea name="items[5][description]" required>6. Flooring with tiles or stones...</textarea>
                    <input type="number" name="items[5][quantity]" placeholder="Qty" required oninput="updateTotal()">
                    <input type="number" name="items[5][price]" placeholder="Price (₹)" required oninput="updateTotal()">
                    <button type="button" onclick="removeItem(this)">Remove</button>
                </div>
                <div class="item-row">
                    <textarea name="items[6][description]" required>7. Painting walls (interior and exterior)...</textarea>
                    <input type="number" name="items[6][quantity]" placeholder="Qty" required oninput="updateTotal()">
                    <input type="number" name="items[6][price]" placeholder="Price (₹)" required oninput="updateTotal()">
                    <button type="button" onclick="removeItem(this)">Remove</button>
                </div>
                <div class="item-row">
                    <textarea name="items[7][description]" required>8. Installation of electrical wiring and fixtures...</textarea>
                    <input type="number" name="items[7][quantity]" placeholder="Qty" required oninput="updateTotal()">
                    <input type="number" name="items[7][price]" placeholder="Price (₹)" required oninput="updateTotal()">
                    <button type="button" onclick="removeItem(this)">Remove</button>
                </div>
                <div class="item-row">
                    <textarea name="items[8][description]" required>9. Plumbing work for bathrooms and kitchens...</textarea>
                    <input type="number" name="items[8][quantity]" placeholder="Qty" required oninput="updateTotal()">
                    <input type="number" name="items[8][price]" placeholder="Price (₹)" required oninput="updateTotal()">
                    <button type="button" onclick="removeItem(this)">Remove</button>
                </div>
            </div>

            <!-- Add Item Button -->
            <button type="button" onclick="addItem()">Add Item</button>

            <!-- Total -->
            <div class="total-container">
                <label>Total:</label>
                <input type="number" name="total" id="total" readonly>
            </div><br>

            <button type="submit">Submit Billing Information</button>
        </form>

        <button onclick="printBillingInfo()">Print Billing Information</button>
    </div>

    <script>
        function removeItem(button) {
            const itemsContainer = document.getElementById('items-container');
            button.parentElement.remove();

            // Re-index item rows
            const itemRows = itemsContainer.querySelectorAll('.item-row');
            itemRows.forEach((row, newIndex) => {
                row.querySelectorAll('textarea, input').forEach(input => {
                    const name = input.getAttribute('name');
                    const updatedName = name.replace(/\[\d+\]/, `[${newIndex}]`);
                    input.setAttribute('name', updatedName);
                });
            });

            updateTotal();
        }

        function printBillingInfo() {
            // Gather billing details
            const customerName = document.querySelector('input[name="customer_name"]').value;
            const customerEmail = document.querySelector('input[name="customer_email"]').value;
            const invoiceNumber = document.getElementById('invoice-number').value;
            const total = document.getElementById('total').value;

            // Gather items into a table structure
            const itemRows = document.querySelectorAll('#items-container .item-row');
            let itemsTable = `
                <table border="1" style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                    <thead>
                        <tr style="background-color: #f4f4f4; text-align: left;">
                            <th>Description</th>
                            <th>Quantity</th>
                            <th>Price (₹)</th>
                            <th>Subtotal (₹)</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            itemRows.forEach((row, index) => {
                const description = row.querySelector(`textarea[name="items[${index}][description]"]`).value;
                const quantity = parseFloat(row.querySelector(`input[name="items[${index}][quantity]"]`).value) || 0;
                const price = parseFloat(row.querySelector(`input[name="items[${index}][price]"]`).value) || 0;
                const subtotal = (quantity * price).toFixed(2);

                itemsTable += `
                    <tr>
                        <td>${description}</td>
                        <td>${quantity}</td>
                        <td>${price.toFixed(2)}</td>
                        <td>${subtotal}</td>
                    </tr>
                `;
            });

            itemsTable += `
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3" style="text-align: right; font-weight: bold;">Total:</td>
                            <td>${total}</td>
                        </tr>
                    </tfoot>
                </table>
            `;

            // Construct print content
            const printContent = `
                <div style="font-family: Arial, sans-serif; padding: 20px;">
                    <h2 style="text-align: center;">Invoice</h2>
                    <p><strong>Invoice Number:</strong> ${invoiceNumber}</p>
                    <p><strong>Customer Name:</strong> ${customerName}</p>
                    <p><strong>Customer Email:</strong> ${customerEmail}</p>
                    ${itemsTable}
                    <p style="text-align: right; font-weight: bold;">Thank you for your business!</p>
                </div>
            `;

            // Print the constructed content
            const originalContents = document.body.innerHTML;
            document.body.innerHTML = printContent;
            window.print();
            document.body.innerHTML = originalContents;
            location.reload(); // Reload the page to restore interactivity
        }
    </script>

</body>

</html>